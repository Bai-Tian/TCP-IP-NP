# 多播与广播

## 多播

多播（Multicast）方式的数据传输基于UDP完成，一次可向多播组中的多个主机同时传送数据。多播组是D类IP地址（224.0.0.0 - 239.255.255.255）。

多播数据包格式与UDP数据包并无二致，但路由器在识别到多播数据包时，会复制该数据包并传递到多个主机。

## 路由、TTL，以及如何加入多播组

为了传递多播数据包，必须设置TTL。用于决定该数据包可传送的距离：每经过一个路由，TTL减1,当TTL减至0时，该数据包就无法再被传递，即销毁。

TTL设置通过`IPPROTO_IP`层的可选项`IP_MULTICAST_TTL`完成。

加入多播组则通过`IPPROTO_IP`层的`IP_ADD_MEMBERSHIP`来完成。

## 广播

虽然作用都是”一次性向多个主机发送数据“，但与多播（multicast）不同的是，广播（broadcast）只能向同一网络中的主机传输数据。

根据传输数据时使用的IP地址的形式，广播可分为：

- 直接广播（Directed Broadcast）：地址中除网络地址外，其余主机地址位全为1（向给定网络中所有主机广播）
- 本地广播（Local Broadcast）：地址为255.255.255.255

默认生成的套接字会阻止广播，使用可选项`SO_BROADCAST`来设置广播。
